;/*FB_PKG_DELIM*/

__d("BaseTextArea.react",["BaseFocusRing.react","BaseInput.react","Locale","react","react-compiler-runtime","stylex","useMergeRefs"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));b=i;var k=b.useEffect,l=b.useRef,m=b.useState,n=d("Locale").isRTL(),o={containerOverride:{backgroundColor:"xjbqb8w",backgroundImage:"x18o3ruo",borderLeftWidth:"xyj58a3",borderRightWidth:"xgfja2r",borderTopWidth:"x972fbf",borderInlineEndWidth:"x10w94by",borderBottomWidth:"x1qhh985",borderInlineStartWidth:"x14e42zd",display:"xrvj5dj",paddingBottom:null,paddingLeft:null,paddingStart:null,paddingEnd:null,paddingRight:null,paddingInlineStart:null,paddingInlineEnd:null,paddingTop:null,position:"x1n2onr6",":active_backgroundColor":"xyftt0y",":active_backgroundImage":"xuqm82a",":focus_backgroundColor":"xyc4ar7",":focus_backgroundImage":"x19zaomo",":hover_backgroundColor":"x1n5bzlp",":hover_backgroundImage":"xn3cpwa",$$css:!0},divOverride:{overflowWrap:"x1mzt3pk",pointerEvents:"x47corl",visibility:"xlshs6z",whiteSpace:"x126k92a",$$css:!0},elementOverride:{gridColumnEnd:"x1ls7aod",gridColumnStart:"xcrlgei",gridRowEnd:"x1byulpo",gridRowStart:"x1agbcgv",lineHeight:"x15bjb6t",marginBottom:null,marginLeft:null,marginRight:null,marginInlineStart:null,marginInlineEnd:null,marginTop:null,$$css:!0},labelRTL:{transformOrigin:"x1h1bmdg",$$css:!0},maxHeight:function(a){return[{WebkitBoxOrient:"x1ua5tub",WebkitLineClamp:a==null?null:"x65k6ix",display:"x104kibb",$$css:!0},{"--WebkitLineClamp":a!=null?a:void 0}]},unresizable:{bottom:"x1ey2m1c",insetInlineEnd:"xtijo5x",insetInlineStart:"x1o0tod",left:null,right:null,position:"x10l6tqk",resize:"xtt52l0",top:"x13vifvy",$$css:!0}};function a(a){var b=d("react-compiler-runtime").c(86),e,f,g,i,q,r,s,t,u,v,w,x,y,z;b[0]!==a?(e=a.addOnEnd,f=a.disabled,g=a.id,i=a.label,t=a.maxRows,u=a.minRows,q=a.placeholder,s=a.ref,v=a.suppressFocusRing,w=a.unresizable,x=a.value,y=a.variant,z=a.xstyle,r=babelHelpers.objectWithoutPropertiesLoose(a,["addOnEnd","disabled","id","label","maxRows","minRows","placeholder","ref","suppressFocusRing","unresizable","value","variant","xstyle"]),b[0]=a,b[1]=e,b[2]=f,b[3]=g,b[4]=i,b[5]=q,b[6]=r,b[7]=s,b[8]=t,b[9]=u,b[10]=v,b[11]=w,b[12]=x,b[13]=y,b[14]=z):(e=b[1],f=b[2],g=b[3],i=b[4],q=b[5],r=b[6],s=b[7],t=b[8],u=b[9],v=b[10],w=b[11],x=b[12],y=b[13],z=b[14]);a=t===void 0?200:t;t=u===void 0?1:u;u=v===void 0?!1:v;var A=w===void 0?!1:w,B=x!=null?String(x):x,C=l(null),D=l(null);v=m(!1);var E=v[0],F=v[1];w=m(!1);x=w[0];var G=w[1],H=c("useMergeRefs")(C,s),I=B!==""&&B!=null;b[15]===Symbol["for"]("react.memo_cache_sentinel")?(v=function(){var a=function(){document.activeElement===C.current?F(!0):F(!1)},b=function(){F(!1),G(!1)},c=function(a){if(a.key==="Shift")return;G(a.key==="Tab")},d=C.current;document.addEventListener("focusin",a);d==null?void 0:d.addEventListener("blur",b);d==null?void 0:d.addEventListener("keyup",c);return function(){document.removeEventListener("focusin",a),d==null?void 0:d.removeEventListener("blur",b),d==null?void 0:d.removeEventListener("keyup",c)}},w=[],b[15]=v,b[16]=w):(v=b[15],w=b[16]);k(v,w);b[17]!==r||b[18]!==B?(s=function(a){var b=a.target.value,c=D.current;if(c!=null&&B!=null){b=b.endsWith("\n")?b+" ":b;c.textContent=b}r.onChange==null?void 0:r.onChange(a)},b[17]=r,b[18]=B,b[19]=s):s=b[19];var J=s;b[20]!==I||b[21]!==g||b[22]!==i||b[23]!==y?(v=function(a){var b;return j.jsx("label",babelHelpers["extends"]({},(h||(h=c("stylex"))).props(((b=y)==null?void 0:b.labelLocation)==="outside"?y.xstyleConfig.labelOutside:[(b=y)==null?void 0:b.xstyleConfig.labelInside,(I||a)&&((b=y)==null?void 0:b.xstyleConfig.labelInsideShrunk)],n&&o.labelRTL),{htmlFor:g,suppressHydrationWarning:!0,children:i}))},b[20]=I,b[21]=g,b[22]=i,b[23]=y,b[24]=v):v=b[24];w=v;b[25]!==f||b[26]!==I||b[27]!==g||b[28]!==H||b[29]!==J||b[30]!==q||b[31]!==r||b[32]!==E||b[33]!==A||b[34]!==B||b[35]!==y||b[36]!==z?(s=function(a){return j.jsx(c("BaseInput.react"),babelHelpers["extends"]({},r,{disabled:f,id:g,onChange:J,placeholder:y!=null&&(I||E)?q:y==null?q:null,ref:H,type:"textarea",value:B,xstyle:[a,A===!0&&o.unresizable,z,(a=y)==null?void 0:a.xstyleConfig.input,f===!0&&((a=y)==null?void 0:a.xstyleConfig.inputDisabled),o.elementOverride]}))},b[25]=f,b[26]=I,b[27]=g,b[28]=H,b[29]=J,b[30]=q,b[31]=r,b[32]=E,b[33]=A,b[34]=B,b[35]=y,b[36]=z,b[37]=s):s=b[37];var K=s;b[38]!==z?(v=(h||(h=c("stylex"))).props(z,o.containerOverride),b[38]=z,b[39]=v):v=b[39];b[40]!==z?(s=(h||(h=c("stylex"))).props(z,o.elementOverride,o.divOverride),b[40]=z,b[41]=s):s=b[41];var L;b[42]!==t?(L=Array.from({length:t!=null?t:1}).map(p),b[42]=t,b[43]=L):L=b[43];b[44]!==s||b[45]!==L?(t=j.jsx("div",babelHelpers["extends"]({},s,{"aria-hidden":"true",ref:D,children:L})),b[44]=s,b[45]=L,b[46]=t):t=b[46];b[47]!==a||b[48]!==z?(s=(h||(h=c("stylex"))).props(z,o.elementOverride,o.divOverride,o.maxHeight(a!=null?a:220)),b[47]=a,b[48]=z,b[49]=s):s=b[49];b[50]!==B?(L=B!=null&&B.endsWith("\n")?B+" ":B,b[50]=B,b[51]=L):L=b[51];b[52]!==s||b[53]!==L?(a=j.jsx("div",babelHelpers["extends"]({},s,{"aria-hidden":"true",ref:D,children:L})),b[52]=s,b[53]=L,b[54]=a):a=b[54];b[55]!==K||b[56]!==y?(s=function(a){var b;return y!=null?j.jsx("div",babelHelpers["extends"]({},(h||(h=c("stylex"))).props((b=y)==null?void 0:b.xstyleConfig.inputWrapper),{children:K(a)})):K(a)},b[55]=K,b[56]=y,b[57]=s):s=b[57];b[58]!==u||b[59]!==s?(L=j.jsx(c("BaseFocusRing.react"),{suppressFocusRing:u,children:s}),b[58]=u,b[59]=s,b[60]=L):L=b[60];if(b[61]!==w||b[62]!==E||b[63]!==((u=y)==null?void 0:u.labelLocation)){u=((s=y)==null?void 0:s.labelLocation)==="inside"&&w(E);b[61]=w;b[62]=E;b[63]=(s=y)==null?void 0:s.labelLocation;b[64]=u}else u=b[64];if(b[65]!==e||b[66]!==((s=y)==null?void 0:s.xstyleConfig)){s=e!=null&&j.jsx("div",babelHelpers["extends"]({},(h||(h=c("stylex"))).props((s=y)==null?void 0:s.xstyleConfig.addOnEndWrapper),{children:e}));b[65]=e;b[66]=(e=y)==null?void 0:e.xstyleConfig;b[67]=s}else s=b[67];b[68]!==v||b[69]!==t||b[70]!==a||b[71]!==L||b[72]!==u||b[73]!==s?(e=j.jsxs("div",babelHelpers["extends"]({},v,{children:[t,a,L,u,s]})),b[68]=v,b[69]=t,b[70]=a,b[71]=L,b[72]=u,b[73]=s,b[74]=e):e=b[74];v=e;if(b[75]!==w||b[76]!==((t=y)==null?void 0:t.labelLocation)){L=((a=y)==null?void 0:a.labelLocation)==="outside"&&w(!1);b[75]=w;b[76]=(u=y)==null?void 0:u.labelLocation;b[77]=L}else L=b[77];if(b[78]!==x||b[79]!==v||b[80]!==E||b[81]!==y){w=y!=null?j.jsx("div",babelHelpers["extends"]({},(h||(h=c("stylex"))).props((s=y)==null?void 0:s.xstyleConfig.container,((e=y)==null?void 0:e.labelLocation)==="outside"&&y.xstyleConfig.labelOutside,E&&((t=y)==null?void 0:t.xstyleConfig.containerActive),x&&E&&((a=y)==null?void 0:a.xstyleConfig.containerFocused)),{children:v})):v;b[78]=x;b[79]=v;b[80]=E;b[81]=y;b[82]=w}else w=b[82];b[83]!==L||b[84]!==w?(u=j.jsxs(j.Fragment,{children:[L,w]}),b[83]=L,b[84]=w,b[85]=u):u=b[85];return u}function p(a,b){return j.jsx("br",{},b)}p.displayName=p.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("FDSDialogFooterButtonGroupItem.react",["CometColumnItem.react","FDSButtonGroup.react","XPlatReactEnvironment","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(12),e,f,g,h;b[0]!==a?(h=a.expanding,f=a.primary,g=a.secondary,e=babelHelpers.objectWithoutPropertiesLoose(a,["expanding","primary","secondary"]),b[0]=a,b[1]=e,b[2]=f,b[3]=g,b[4]=h):(e=b[1],f=b[2],g=b[3],h=b[4]);a=h===void 0?!0:h;h=d("XPlatReactEnvironment").isWeb()?a:!1;b[5]!==e||b[6]!==f||b[7]!==g?(a=i.jsx(c("FDSButtonGroup.react"),babelHelpers["extends"]({paddingHorizontal:0,paddingTop:0,primary:f,secondary:g},e)),b[5]=e,b[6]=f,b[7]=g,b[8]=a):a=b[8];b[9]!==h||b[10]!==a?(e=i.jsx(c("CometColumnItem.react"),{expanding:h,paddingVertical:16,children:a}),b[9]=h,b[10]=a,b[11]=e):e=b[11];return e}g["default"]=a}),98);
__d("FDSDialogButtonGroupFooter.react",["FDSDialogFooterButtonGroupItem.react","FDSDialogFooterContainer.react","FDSDialogMetaTextItem.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(18),e,f,g;b[0]!==a?(f=a.meta,g=a.metaPosition,e=babelHelpers.objectWithoutPropertiesLoose(a,["meta","metaPosition"]),b[0]=a,b[1]=e,b[2]=f,b[3]=g):(e=b[1],f=b[2],g=b[3]);a=g===void 0?"above":g;g=f!=null&&a==="above";var h=f!=null&&a==="below",j;b[4]!==g||b[5]!==f||b[6]!==a?(j=g&&i.jsx(c("FDSDialogMetaTextItem.react"),{meta:f,metaPosition:a}),b[4]=g,b[5]=f,b[6]=a,b[7]=j):j=b[7];b[8]!==e?(g=i.jsx(c("FDSDialogFooterButtonGroupItem.react"),babelHelpers["extends"]({},e)),b[8]=e,b[9]=g):g=b[9];b[10]!==h||b[11]!==f||b[12]!==a?(e=h&&i.jsx(c("FDSDialogMetaTextItem.react"),{meta:f,metaPosition:a}),b[10]=h,b[11]=f,b[12]=a,b[13]=e):e=b[13];b[14]!==j||b[15]!==g||b[16]!==e?(h=i.jsxs(c("FDSDialogFooterContainer.react"),{children:[j,g,e]}),b[14]=j,b[15]=g,b[16]=e,b[17]=h):h=b[17];return h}g["default"]=a}),98);
__d("FDSPhotoAddFilled24Icon",["cr:15400"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:15400")}),98);
__d("FDSPhotoAddFilled24PNGIcon.react",["ix","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";a=d("fbicon")._(h("481777"),24);b=a;g["default"]=b}),98);
__d("LSArrayRemoveObjectAt",["I64","LSSynchronousPromise"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,c,e){return d("LSSynchronousPromise").makeSynchronousPromise([c.splice((h||(h=d("I64"))).to_int32(e),1)])}g.call=a}),98);
__d("LSCollapseAttachments",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return b.islc(b.sortBy(b.db.table(16).fetch([[[a[0],a[1]]],"idx_attachments_collapsible_id"]),[["timestampMs","DESC"]]),0,b.i64.to_float(b.i64.cast([0,1]))).next().then(function(d,e){var f=d.done;d=d.value;return f?0:(e=d.item,b.sequence([function(d){return c[0]=e.messageId,b.forEach(b.db.table(16).fetch([[[a[0],a[1],{lt:c[0]}],[a[0],a[1],{gt:c[0]}]],"idx_attachments_collapsible_id"]),function(a){var c=a.item;return b.forEach(b.filter(b.db.table(12).fetch([[[c.threadKey,c.timestampMs,c.messageId]]]),function(a){return b.i64.eq(a.threadKey,c.threadKey)&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))&&b.i64.eq(a.timestampMs,c.timestampMs)&&a.messageId===c.messageId}),function(a){var b=a.update;a.item;return b({isCollapsed:!0})})})},function(a){return b.forEach(b.filter(b.db.table(12).fetch([[[e.threadKey,e.timestampMs,c[0]]]]),function(a){return b.i64.eq(a.threadKey,e.threadKey)&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))&&b.i64.eq(a.timestampMs,e.timestampMs)&&a.messageId===c[0]}),function(a){var b=a.update;a.item;return b({isCollapsed:!1})})}]))})},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxCollapseAttachmentsStoredProcedure";a.__tables__=["attachments","messages"];e.exports=a}),null);
__d("LSUpdateOrInsertReactionV2",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return b.db.table(226).fetch([[[a[0],a[1],a[2]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?b.db.table(12).fetch([[[a[1]]],"messageId"]).next().then(function(d,e){var c=d.done;d=d.value;return c?0:(e=d.item,b.sequence([function(c){return b.forEach(b.filter(b.db.table(226).fetch([[[a[0],a[1],a[2]]],"optimistic"]),function(c){return b.i64.eq(c.threadKey,a[0])&&c.messageId===a[1]&&b.i64.eq(c.reactionFbid,a[2])&&b.i64.lt(c.authorityLevel,a[5])}),function(a){return a["delete"]()})},function(c){return b.db.table(226).add({messageId:a[1],threadKey:a[0],reactionFbid:a[2],messageTimestamp:e.timestampMs,authorityLevel:a[5],count:a[4],viewerIsReactor:a[6],viewerReactionTimestampMs:a[7],lastUpdatedTimestampMs:a[8]})}]))}):(e=d.item,c[2]=e.lastUpdatedTimestampMs,c[1]=e.authorityLevel,b.i64.eq(a[5],b.i64.cast([0,20]))||b.i64.eq(c[1],b.i64.cast([0,80]))&&b.i64.eq(a[5],b.i64.cast([0,80]))||b.i64.eq(c[1],b.i64.cast([0,20]))&&b.i64.eq(a[5],b.i64.cast([0,80]))&&b.i64.le(b.i64.add(c[2],b.i64.cast([0,2e3])),a[8])||b.i64.eq(c[1],b.i64.cast([0,20]))&&b.i64.eq(a[5],b.i64.cast([0,60]))||b.i64.eq(c[1],b.i64.cast([0,60]))&&b.i64.eq(a[5],b.i64.cast([0,80]))&&b.i64.le(c[2],a[8])?c[3]=!0:c[3]=!1,c[3]?b.db.table(226).put({messageId:a[1],threadKey:a[0],reactionFbid:a[2],messageTimestamp:e.messageTimestamp,reactionLiteral:a[3],count:a[4],authorityLevel:a[5],viewerIsReactor:a[6],viewerReactionTimestampMs:b.i64.cast([0,0]),lastUpdatedTimestampMs:a[8]}):b.resolve())})},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxUpdateOrInsertReactionV2StoredProcedure";a.__tables__=["reactions_v2","messages"];e.exports=a}),null);
__d("LsFalcoEventEntryPoint",[],(function(a,b,c,d,e,f){"use strict";a="message_actions";b="composer";c="icebreaker";f.messageActions=a;f.composer=b;f.icebreaker=c}),66);
__d("LsMessageActionFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("2051889");b=d("FalcoLoggerInternal").create("ls_message_action",a);e=b;g["default"]=e}),98);
__d("MAWAudioUtils",["FBLogger","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var d=URL.createObjectURL(a);return new(h||(h=b("Promise")))(function(a,b){var e=new Audio();e.setAttribute("crossOrigin","anonymous");e.addEventListener("loadedmetadata",function(c){c=c.currentTarget;if(c instanceof HTMLAudioElement){c=c.duration;a(Math.ceil(c))}else b("EventTarget returned for event should be HTMLAudioElement")});e.src=d;e.onabort=function(){b(function(){throw c("FBLogger")("messenger_web").mustfixThrow("Error loading audio from provided URL")})};e.onerror=function(){b(function(){throw c("FBLogger")("messenger_web").mustfixThrow("Wrong blob type")})}})}g.getAudioDurationInSeconds=a}),98);
__d("MAWAudioPreProcess",["MAWAudioUtils","WABlobToArrayBuffer","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["start optimistic audio preprocess"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["start audio preprocess"]);i=function(){return a};return a}var j=d("WATagsLogger").TAGS(["MAWAudioPreProcess"]),k=["audio/ogg","audio/x-flac","audio/flac"];function b(a){j.LOG(i());return d("MAWAudioUtils").getAudioDurationInSeconds(a).then(async function(b){return{durations:b,file:a,isPtt:!0,plaintext:await d("WABlobToArrayBuffer").blobToArrayBuffer(a),type:"audio"}})}function c(b){var c=a.URL.createObjectURL(b);j.LOG(h());return d("MAWAudioUtils").getAudioDurationInSeconds(b).then(function(a){return Promise.resolve({durations:a,file:b,isPtt:!0,type:"audio",url:c})})}function e(a){return!a.startsWith("audio/")?!1:!k.includes(a)}g.audioPreprocess=b;g.optimisticAudioPreprocess=c;g.isSupportedAudioFileType=e}),98);
__d("MAWSendVideoToWorker",["MAWMediaWorkerResource","Promise","WALogger","WebWorker"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Clean up media worker"]);i=function(){return a};return a}var j=k();function a(a){var c;return new(h||(h=b("Promise")))(function(b){c=j&&l(j)?k():j,c.setMessageHandler(function(a){b(a)}).execute(),c.postMessage(a)})["finally"](function(){c&&(d("WALogger").LOG(i()),c.terminate(),(!j||!j.isCurrentState("constructed"))&&(j=k()))})}function k(){return new(c("WebWorker"))(c("MAWMediaWorkerResource")).setAllowCrossPageTransition(!0)}function l(a){return a.isCurrentState("preparing")||a.isCurrentState("executing")}g.sendVideoMessageToWorker=a}),98);
__d("MAWVideoPreProcess",["MAWMediaPreProcessQpl","MAWSendVideoToWorker","MAWVideoUtils","MWFBLogger","MWPBumpEntityKey","WABlobToArrayBuffer","WAMediaWasmWorkerClient","WAResultOrError","cometIsMimeTypeForMedia"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:checkAndRepair got error! ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:checkAndRepair rejected file (",")"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["MediaAnalyzer:checkAndRepair got parsing error! ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["trouble parsing file "," (fossil ",") ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["start process video through asm.js, file name: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["start process video through wasm, file name: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unable to preprocess video: ",""]);n=function(){return a};return a}var o=["video/x-ms-wmv","video/x-msvideo","video/avi","video/x-flv","video/ogg","video/mpeg"],p=d("MWFBLogger").MWMediaLogger.tags(["MAWVideoPreProcess"]),q=typeof self.BigInt==="function";function b(a,b){return r(a,b).then(function(b){if(!b.success){b.error;return Promise.reject(b.error)}b=(b=b.value)!=null?b:a;return Promise.all([b,d("MAWVideoUtils").getVideoThumbnailUrlAndSpec(b)]).then(async function(a){var b=a[0];a=a[1];return{file:b,plaintext:await d("WABlobToArrayBuffer").blobToArrayBuffer(b),thumbnailUrlAndSpec:a,type:"video"}})})}async function c(b){await r(b).then(function(a){if(!a.success){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("maw.composer","invalid_video_send_block_with_type_"+b.type);a.error;return Promise.reject(a.error)}return});var c=await d("MAWVideoUtils").getVideoThumbnailSpec(b),e=a.URL.createObjectURL(b);return Promise.resolve({file:b,thumbnailSpec:c,type:"video",url:e})}function r(a,b){var c=q,e=d("MAWMediaPreProcessQpl").startMediaPreProcessQpl("video",a);e.addAnnotations({bool:{wamedia_wasm_enabled:c},int:{total_number_of_files:b!=null?b:1}});b=c?s(a,e):t(a);return b.then(function(a){if(!a.success)switch(a.error){case"invalid-media":e.endFail("invalid-media");return d("WAResultOrError").makeError("invalid-mp4");case"worker-connection-timeout":case"worker-connection-runtime-error":case"internal-error":case"decode-image-error":case"undefined-operation":case"runtime-error":throw a.error;default:a.error;throw a.error}e.endSuccess({int:{compressed_file_size:a.value.size}});return d("WAResultOrError").makeResult(a.value)}).catch(function(b){p.MUSTFIX(n(),b.toString());e.endFail("unable_to_process_video",{string:{preprocessError:b.toString()}});return d("WAResultOrError").makeResult(a)})}async function s(a,b){p.DEBUG(m(),a.name);var c=await a.arrayBuffer();b=await d("WAMediaWasmWorkerClient").mp4RepairMuxInWorker({eventFlow:b,input:new Uint8Array(c)});if(!b.success)return b;c=new File([b.value],a.name,{type:"video/mp4"});return d("WAResultOrError").makeResult(c)}function t(a){p.DEBUG(l(),a.name);return u(a).then(function(b){if(!b)return d("WAResultOrError").makeError("invalid-media");b=new File([b.file],a.name,{type:b.file.type});return d("WAResultOrError").makeResult(b)})}function u(a){return d("MAWSendVideoToWorker").sendVideoMessageToWorker({asGif:!1,file:a,type:"prep"}).then(function(a){var b=a.error,c=a.file,d=a.filename,e=a.result;a=a.type;switch(a){case"result":return e;case"parsingError":p.MUSTFIX(k(),c,d,String(b));c&&p.MUSTFIX(j(),String(b));p.MUSTFIX(i(),String(b));return void 0}}).catch(function(a){p.MUSTFIX(h(),String(a));return void 0})}function e(a){return!d("cometIsMimeTypeForMedia").isMimeTypeForVideo(a)?!1:!o.includes(a)}g.videoPreprocess=b;g.optimisticVideoPreprocess=c;g.processVideoThroughWasm=s;g.processVideoThroughAsmJs=t;g.isSupportedVideoFileType=e}),98);
__d("MAWMediaPreprocess",["MAWAudioPreProcess","MAWDocumentPreProcess","MAWImagePreProcess","MAWSupportedDocumentTypes","MAWVideoPreProcess","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["start optimistic mediaPreprocess, file name: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["start mediaPreprocess, file name: ",""]);i=function(){return a};return a}var j=d("WATagsLogger").TAGS(["MAWMediaPreprocess"]);function a(a,b,c){j.DEV(i(),a.name);return k(a,function(a){return d("MAWImagePreProcess").imagePreprocess(a,!1,b,c)},function(a){return d("MAWVideoPreProcess").videoPreprocess(a,b)},d("MAWAudioPreProcess").audioPreprocess,d("MAWDocumentPreProcess").documentPreprocess)}function b(a){j.DEV(h(),a.name);return k(a,d("MAWImagePreProcess").optimisticImagePreprocess,d("MAWVideoPreProcess").optimisticVideoPreprocess,d("MAWAudioPreProcess").optimisticAudioPreprocess,d("MAWDocumentPreProcess").optimisticDocumentPreprocess)}function k(a,b,c,e,f){if(a.size===0)return Promise.reject("Empty file");if(d("MAWImagePreProcess").isSupportedImageFileType(a.type))return b(a);if(d("MAWVideoPreProcess").isSupportedVideoFileType(a.type))return c(a);if(d("MAWAudioPreProcess").isSupportedAudioFileType(a.type))return e(a);return d("MAWSupportedDocumentTypes").isAllowedType(a.name)?f(a):Promise.reject("Unsupported file type")}g.mediaPreprocess=a;g.optimisticMediaPreprocess=b}),98);
__d("MWMediaManagerTypes",["MessagingAttachmentType"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a){case"animated_image":return c("MessagingAttachmentType").ANIMATED_IMAGE;case"image":return c("MessagingAttachmentType").IMAGE;case"video":return c("MessagingAttachmentType").VIDEO;case"audio":return c("MessagingAttachmentType").AUDIO;case"document":return c("MessagingAttachmentType").FILE;default:return null}}g.getMessagingAttachmentTypeFromMediaMetadataAttachmentType=a}),98);
__d("MAWMediaManagerUtils",["FBLogger","MAWBridgeFireAndForget","MAWMediaPreprocess","MAWMediaUtils","MAWMiActOnActThreadReady","MWMediaManagerTypes","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map();function a(a,b){var c=b===!0;return Promise.all(a.map(async function(e){var f=e[0];e=e[1];var g=d("MAWMediaPreprocess").mediaPreprocess(f,a.length,b),i=await d("MAWMediaPreprocess").optimisticMediaPreprocess(f);h.set(e,{optimisticMedia:i,originalFile:f,processedMediaPromise:g});g=d("MWMediaManagerTypes").getMessagingAttachmentTypeFromMediaMetadataAttachmentType(i.type);f={attachmentType:g!=null?g:void 0,file:f,isHd:c,offlineAttachmentId:e,previewHeight:(f=(g=i.imageSpec)==null?void 0:g.height)!=null?f:void 0,previewWidth:(g=(e=i.imageSpec)==null?void 0:e.width)!=null?g:void 0};return Promise.resolve(f)}))}function b(a,b,e){c("promiseDone")(d("MAWMiActOnActThreadReady").onActThreadReady(a.tables,b,"MAWMediaManagerUtils",async function(a,b){a=e.reduce(function(a,b){b=(b=h.get(b.offlineAttachmentId))==null?void 0:b.processedMediaPromise;b!=null&&a.push(b);return a},[]);a=await Promise.all(a);a.forEach(function(a){var e;switch(a.type){case"image":return d("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:a.file,jid:b,thumbnail:d("MAWMediaUtils").convertJpegThumbnailArrayBufferToFile((e=a.thumbnailUrlAndSpec)==null?void 0:e.jpegThumbnail)});case"animated_image":return d("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:a.file,jid:b,thumbnail:null});case"video":return d("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:a.file,jid:b,thumbnail:d("MAWMediaUtils").convertJpegThumbnailArrayBufferToFile(a.thumbnailUrlAndSpec.jpegThumbnail)});case"audio":return d("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:a.file,jid:b,thumbnail:null});case"document":return d("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:a.file,jid:b,thumbnail:null});default:c("FBLogger")("messenger_web_media").mustfix("MAW Optimistic upload media: unknown media attachment file type: "+a.type)}});return Promise.resolve()}))}function e(a,b,e){c("promiseDone")(d("MAWMiActOnActThreadReady").onActThreadReady(a.tables,b,"MAWMediaManagerUtils",function(a,b){e.forEach(function(a){return d("MAWBridgeFireAndForget").fireAndForget("backend","optimisticUploadMedia",{file:a,jid:b,thumbnail:null})});return Promise.resolve()}))}g.MAWMediaManagerAttachmentsV2=h;g.preprocessV2=a;g.upload=b;g.uploadForXMA=e}),98);
__d("MwbActorExperienceEventFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("3231");b=d("FalcoLoggerInternal").create("mwb_actor_experience_event",a);e=b;g["default"]=e}),98);
__d("WebUserFlowLoggingDataContextProvider.react",["react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;c=b.createContext;b.useMemo;var j=b.useRef,k=c({loggingDataRef:{current:{}},setLoggingData:function(){}});function a(a){var b=d("react-compiler-runtime").c(5);a=a.children;var c;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(c={},b[0]=c):c=b[0];var e=j(c);b[1]===Symbol["for"]("react.memo_cache_sentinel")?(c=function(a){e.current=a},b[1]=c):c=b[1];c=c;b[2]===Symbol["for"]("react.memo_cache_sentinel")?(c={loggingDataRef:e,setLoggingData:c},b[2]=c):c=b[2];c=c;c=c;b[3]!==a?(c=i.jsx(k.Provider,{value:c,children:a}),b[3]=a,b[4]=c):c=b[4];return c}g.WebUserFlowLoggingDataContext=k;g.WebUserFlowLoggingDataContextProvider=a}),98);
__d("declareNUXRequireable",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a}f["default"]=a}),66);
__d("useLogMAWEditMessage",["I64","LSMessagingThreadTypeUtil","LsFalcoEventEntryPoint","LsMessageActionFalcoEvent","MessengerWebUXLogger","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;(h||d("react")).useCallback;function a(){var a=d("react-compiler-runtime").c(2),b=c("MessengerWebUXLogger").useInteractionLogger(),e;a[0]!==b?(e=function(a,e,f,g,h){d("LSMessagingThreadTypeUtil").isArmadilloSecure(a)?b==null?void 0:b({eventName:j(h)}):c("LsMessageActionFalcoEvent").log(function(){return{action:{type:k(h)},error:{message:void 0},extra:{is_community_chats:d("LSMessagingThreadTypeUtil").isPublicCMThread(a)?"1":"0"},message:{attachment_type:"",entry_point:d("LsFalcoEventEntryPoint").messageActions,id:f,recipient_id:(i||(i=d("I64"))).to_string(g)},thread:{group_size:i.to_string(i.zero),id:e!=null?(i||(i=d("I64"))).to_string(e):void 0,type:d("LSMessagingThreadTypeUtil").isGroup(a)?2:1}}})},a[0]=b,a[1]=e):e=a[1];return e}function j(a){switch(a){case"EDIT_MESSAGE":return"edit_message";case"EDIT_MESSAGE_CANCEL":return"edit_message_cancel";case"EDIT_MESSAGE_TAP":return"edit_message_tap"}}function k(a){switch(a){case"EDIT_MESSAGE":return 90;case"EDIT_MESSAGE_CANCEL":return 92;case"EDIT_MESSAGE_TAP":return 89}}g["default"]=a}),98);
__d("useMWEntrypoint",["MWLSThreadDisplayContext"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=d("MWLSThreadDisplayContext").useMWLSThreadDisplayContext(),b="inbox";bb0:switch(a){case"ChatTab":b="popup_chat_box";break bb0;case"RoomsSideChat":b="rooms_lobby"}return b}g["default"]=a}),98);
__d("useMWXConfirmationDialog",["fbt","JSResourceForInteraction","react","react-compiler-runtime","useMWXLazyDialog"],(function(a,b,c,d,e,f,g,h){"use strict";var i;(i||d("react")).useCallback;var j=c("JSResourceForInteraction")("MWXConfirmationDialog.react").__setRef("useMWXConfirmationDialog");function a(){var a=d("react-compiler-runtime").c(2),b=c("useMWXLazyDialog")(j),e=b[0];a[0]!==e?(b=function(a,b,c){var d=a.cancel,f=a.confirm;a=babelHelpers.objectWithoutPropertiesLoose(a,["cancel","confirm"]);d=d===void 0?h._(/*BTDS*/"Cancel"):d;f=f===void 0?h._(/*BTDS*/"Confirm"):f;e(babelHelpers["extends"]({cancel:d,confirm:f},a),function(a){return a?b():c==null?void 0:c()})},a[0]=e,a[1]=b):b=a[1];return b}g["default"]=a}),226);